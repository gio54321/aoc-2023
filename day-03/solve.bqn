#! /usr/bin/env bqn
dataâ†â€¢FLines "input.txt"

dataâ†©{ğ•©âˆ¾"."}Â¨data
hlâ†â‰ âˆ¾1â†‘data
vlâ†â‰ data

partsâ†>{(11)=ğ•©}{".0123456789"âŠğ•©}Â¨data
parts {(ğ•©+(hlâ¥Š0)Â»ğ•©)+(hlâ¥Š0)Â«ğ•©}â†©
parts {(ğ•©+â‰(vlâ¥Š0)Â»â‰ğ•©)+â‰(vlâ¥Š0)Â«â‰ğ•©}â†©
parts {â¥Š â‹ˆË˜0<Â¨ğ•©}â†©

nsâ†âˆ¾Â´{10â‰ ğ•©}{"0123456789"âŠğ•©}Â¨data
ns {ğ•©Ã—1++`1âŒŠ(Â»âŠ¸+)Â¬ğ•©}â†©
numbersâ†1â†“nsâŠ”âˆ¾Â´data
idxâ†Â¯1+(+`âŠ¸Ã—)0<Â¨â‰ Â¨numbers

numbers {(10âŠ¸Ã—âŠ¸+ËœÂ´âˆ˜âŒ½-âŸœ'0')Â¨â¥Šâˆ¾idxâŠ”ğ•©}â†©
isPartâ†1â†“nsâŠ”âˆ¾Â´parts
resultâ†+Â´numbersÃ—1âŒŠ(+Â´)Â¨â¥Šâˆ¾idxâŠ”isPart
â€¢Show result